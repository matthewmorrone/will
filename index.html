<html>
<head>
<!--<meta http-equiv="refresh" content="30">-->
<base href="/will/">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Access-Control-Allow-Origin" content="*">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Will | Will is a modern responsive business and corporate theme that helps you to create a strong–yet beautiful–online presence for your business</title>
<meta name="robots" content="noindex,follow">
<meta name="theme-color" content="#e1dfdf">
<!-- <link rel="shortcut icon"   type="image/x-icon" href="/favicon.ico"> -->
<!-- <link rel="icon"            type="image/x-icon" href="/favicon.ico"> -->
<!-- <link rel="shortcut icon"   type="image/x-icon" href="http://superdupergc.com/press/black_ice/images/blackicelogo.png" /> -->
<link rel="shortcut icon"   type="image/x-icon" href="http://www.matthewmorrone.com/psi.ico" />
<script>
log = console.log.bind(console)
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-color/2.1.2/jquery.color.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment-range/3.0.3/moment-range.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/autosize.js/3.0.20/autosize.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-url/2.5.0/url.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/js/bootstrap.js"></script>


<script src="https://cloud.tinymce.com/stable/tinymce.min.js?apiKey=w2gkux7gagnlvx1jmtsi6j4jxhg8aogi6wcv9tfxkihcfz8l"></script>


<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/page.js/1.7.1/page.js"></script> -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crossroads/0.12.2/crossroads.js"></script> -->
<!-- <script type="text/javascript" src="https://cdn.rawgit.com/tunnckoCore/gibon/master/dist/gibon.umd.js"></script> -->
<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gibon/0.4.1/gibon.umd.js"></script> -->

<link rel="stylesheet" href="fonts.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin|Rubik|Orbitron">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css" id='bootstrap'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-wysiwyg/0.3.3/bootstrap3-wysihtml5.css" />


<script type="text/javascript" src="navigo.js"></script>
<script>
log(window.location)
String.prototype.capital = function capital() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}
// function updateUrlParameter(param, value) {
//     var regExp = new RegExp(param + "(.+?)(&|$)", "g");
//     var newUrl = window.location.href.replace(regExp, param + "=" + value + "$2");
//     window.history.pushState("", "", newUrl);
// }
function blogEntry(mode) {
    $.post('server.php', {mode: mode}, function(entry) {
        entry = JSON.parse(entry)
        $('.entry').attr('hidden', false)
        $('.blog-title').html(entry.title)
        $('.blog-id').html(entry.id)
        $('.blog-created').html(moment(entry.created).format('MMMM Do, YYYY'))
        $('.blog-created').attr('href', window.location.href)
        $('.blog-modified').html(entry.modified)
        $('.blog-image').attr('src', entry.image)
        $('.blog-blurb').html(entry.blurb)
        $('.blog-content').html(entry.content)
        $('html, body').animate({scrollTop: 0}, 'slow')
        document.title = 'Will | ' + entry.title
    }, 'text')
}
$(document).on('change', '#theme', function(e) {
    log($(this).find(':selected').text(), this, $(this))
    localStorage.theme = $(this).find(':selected').text()
    $('#bootstrap').attr('href', $(this).val())
})
$(document).on('click', '.preview', function(e) {
    e.preventDefault()
    $('#theme').val('https://bootswatch.com/'+$(this).attr('theme').toLowerCase()+'/bootstrap.css').change()
})

function externalize() {
    var comp = new RegExp(location.host)
    $('.jumbotron a').each(function() {
        if(comp.test($(this).attr('href'))) {
        }
        else {
            $(this).attr('target', '_blank')
        }
    })
}


$(function() {

    var router = new Navigo()
    router.on('/themes', function (params, query) {
        $.post('bootswatch.3.json', function(d) {
            $.each(d.themes, function(i, theme) {
                theme.name = theme.name.capital()
                var $article = $('#template').clone().removeAttr('id').removeAttr('hidden')
                $article.find('.entry-title h1').html(theme.name)
                $article.find('.entry-thumbnail img').attr('src', theme.thumbnail)
                $article.find('.entry-thumbnail img').attr('theme', theme.name)
                $article.find('.entry-thumbnail img').addClass('preview')
                $article.find('.entry-summary').html(theme.description)
                $article.find('a').attr('href', theme.preview)
                $article.find('a').attr('target', '_blank')
                $('.blog-posts-wrapper').append($article)
            })
            $('[href="themes"]').parent().addClass('active')
            document.title = 'Will | Themes'

        })

    })
    router.on('/blog/new', function (params, query) {

        $('.jumbotron').attr('hidden', false)

        $('.entry-summary').append($('<textarea></textarea>', {id: 'tinymce'}))
        tinymce.init({selector: '#tinymce'})
        $('.panel-body').css('padding', 0)
        $('.blog-image, .blog-content').remove()
        $('.blog-title, .blog-blurb').attr('contenteditable', true)
        $('.blog-title, .blog-blurb').css('border', '1px dashed gray')


    })
    router.on('/blog/:id', function (params, query) {
        blogEntry(params.id)
        $.post('server.php', {mode: 'all'}, function(posts) {
            posts.forEach(function(entry) {
                entry = entry[0]
                var $article = $('#template').clone().removeAttr('id').removeAttr('hidden')
                $article.find('.entry-title h1').html(entry.title)
                $article.find('.entry-thumbnail img').attr('src', entry.image)
                $article.find('.entry-summary').html(entry.blurb)
                $article.find('a').attr('href', 'blog/'+entry.id)
                $('.blog-posts-wrapper').append($article)
            })
            $('.jumbotron').attr('hidden', false)
            externalize()
        }, 'json')
    })
    router.on('/blog', function (params, query) {
        $.post('server.php', {mode: 'all'}, function(posts) {
            log(posts)
            posts.forEach(function(entry) {
                entry = entry[0]
                var $article = $('#template').clone().removeAttr('id').removeAttr('hidden')
                $article.find('.entry-title h1').html(entry.title)
                $article.find('.entry-thumbnail img').attr('src', entry.image)
                $article.find('.entry-summary').html(entry.blurb)
                $article.find('a').attr('href', 'blog/'+entry.id)
                $('.blog-posts-wrapper').append($article)
            })
            $('[href="blog"]').parent().addClass('active')
            document.title = 'Will | Blog'
        }, 'json')
    })
    router.on(function(query) {
        $('.jumbotron').removeAttr('hidden')
        $('[href=""]').parent().addClass('active')
        document.title = 'Will | Home'

    })
    router.resolve()





    var defaultTheme = localStorage.theme || 'Cyborg'
    $.post('bootswatch.3.json', function(d) {
        $.each(d.themes, function(i, theme) {
            theme.name = theme.name.capital()
            $('#theme').append($('<option></option>', {text: theme.name, val: theme.css, selected: (theme.name === defaultTheme ? true : false)}))
            if (theme.name === defaultTheme) {
                $('#bootstrap').attr('href', theme.css)
            }
        })
    })

})

</script>
<style>
::-webkit-scrollbar {
    display: none;
}
body {
    width: 100%;
    height: 100%;
}
h1 {
    margin: auto !important;
    text-align: center;
}
.site {
    width: 70%;
    margin: auto;
}
.jumbotron {
    padding-left: 60px;
    padding-right: 60px;
}
.blog-posts-wrapper {
    display: flex;
    flex-flow: row wrap;
}
.blog-posts .panel {
    /*float: left;*/
    width: 33.33%;
}
.panel img {
    border-radius: 20px;
    padding: 10px 15px;
    width: 100%;
}
footer {
    clear: both;
}
footer nav {
    float: right;
    text-align: right;
}
footer li {
    display: inline-block;
    margin: 0 8px 0 0;
    font-weight: bold;
    text-transform: uppercase;
}
.mce-branding-powered-by {
    display: none !important;
}

.panel-default {
    display: flex;
    flex-direction: column;
}
.panel-body {
    flex-grow: 1;
}
#template {
    display: none;
}
</style>
</head>
<body>
<div class="site">
    <header>
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand" href="https://www.fallenreaper.com/">Will</a>
                </div>
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

                    <ul class="nav navbar-nav">
                        <li><a href="">Home</a></li>
                        <li><a href="blog">Blog</a></li>
                        <li><a href="themes">Themes</a></li>
<!--                         <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Themes <span class="caret"></span></a>
                            <ul class="dropdown-menu" id='theme-listing'>
                                <li><a href="#">Action</a></li>
                                <li><a href="#">Another action</a></li>
                                <li><a href="#">Something else here</a></li>
                                <li class="divider"></li>
                                <li><a href="#">Separated link</a></li>
                                <li class="divider"></li>
                                <li><a href="#">One more separated link</a></li>
                            </ul>
                        </li> -->
                    </ul>
                    <form class="navbar-form navbar-right" role="search">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search">
                        </div>
                        <select id='theme' class="form-control"></select>
                    </form>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#">Phone: 412 555 1234</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <content>
        <div id='jumbotron' class="jumbotron" hidden>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h1 class='blog-title'></h1>
                    <p class='blog-blurb'></p>

                </div>
                <div class="panel-body entry-summary">
                    <img class='blog-image' />
                    <p class='blog-content'></p>

                </div>
                <div class="panel-footer">
                    <div class='timestamp' hidden>Created on <a href='' class='blog-created'></a></div>
                    <div class='timestamp' hidden>Modified on <a href='' class='blog-modified'></a></div>
                </div>
            </div>

            <!-- <hr> -->
            <!-- <div class='blog-content'></div> -->
            <!-- <p><a class="btn btn-primary btn-lg">Learn more</a></p> -->
        </div>

        <div class="blog-posts">
            <div id='template' class="panel panel-default" hidden>
                <div class="panel-heading entry-title"><h1></h1></div>
                <div class="panel-body entry-summary"></div>
                <a class="entry-thumbnail" href=""><img src=""></a>
                <div class="panel-footer"><a class="btn btn-primary more btn-lg btn-block" href="#">Read more</a></div>
            </div>
            <div class="blog-posts-wrapper clear">


            </div>
        </div>
    </content>
    <footer class="well">
        <nav>
            <ul>
                <li><a href="https://www.fallenreaper.com/blog/">Blog</a></li>
                <li><a href="https://www.fallenreaper.com/about-us/">About us</a></li>
                <li><a href="https://www.fallenreaper.com/contact-us/">Contact us</a></li>
            </ul>
        </nav>
        <div>
            <a href="#">&copy; 2017 A Fallen Reaper Site</a>
        </div>
    </footer>
</div>
</body>
</html>